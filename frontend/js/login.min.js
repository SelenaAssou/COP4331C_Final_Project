/*!
 * Start Bootstrap - SB Admin v5.0.2 (https://startbootstrap.com/template-overviews/sb-admin)
 * Copyright 2013-2018 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-sb-admin/blob/master/LICENSE)
 */

var urlBase="https://poosgroup5-u.cf/",extension="py";function doLogin(){var e=document.getElementById("inputUsername"),t=document.getElementById("inputPassword"),a='{"username" : "'+e.value+'", "password" : "'+t.value+'"}',s=urlBase+"api/login",n=new XMLHttpRequest;n.open("POST",s,!1),n.setRequestHeader("Content-type","application/json; charset=UTF-8");try{n.send(a);var r=JSON.parse(n.responseText);if(r.success<1)return $(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Login failed!</strong> Make sure you typed everything correctly. </div>'),!1;localStorage.setItem("sessionID",r.sessionID),window.location.replace(urlBase+"main.html")}catch(e){alert(e)}}function doRegister(){var e=document.getElementById("inputUsername").value,t=document.getElementById("inputPassword").value;if(t==document.getElementById("confirmPassword").value){var a='{"username":"'+e+'", "password":"'+t+'", "isAdmin":0}',s=urlBase+"api/register",n=new XMLHttpRequest;n.open("POST",s,!1),n.setRequestHeader("Content-type","application/json; charset=UTF-8");try{n.send(a),1==JSON.parse(n.responseText).success?window.location.replace(urlBase+"login.html"):$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible" id="badRegister">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Error!</strong> Something went wrong! Please try again later. </div>')}catch(e){alert(e.message)}}else $(document.getElementById("addMessage")).append('<div class="alert alert-info alert-dismissible" id="passwordIssue">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Passwords do not match!</strong> Did not register user. </div>')}function searchBugsAndPopulateTable(){var e=urlBase+"api/search",t=new XMLHttpRequest;t.open("POST",e,!1),t.setRequestHeader("Content-type","application/json; charset=UTF-8");try{t.send("{}");var a=JSON.parse(t.responseText);if(1==a.success){var s=document.getElementById("bugs");Array.from(a.results).forEach(function(e,t){addRowOnTable(s,e,t)}),$(document).ready(function(){$("#bugs").DataTable()})}}catch(e){alert(e)}}function addRowOnTable(e,t,a){null!=t&&($(e).find("tbody").append("<tr><td>"+t.common_name+"</td><td>"+t.scientific_name+"</td><td> <a class='btn btn-sm btn-primary' style='color:white' id='button"+t.id+"'>Edit</a> </td></tr>"),document.getElementById("button"+t.id).onclick=function(){editBug(t.id)})}function editBug(e){localStorage.setItem("editbugID",e),window.location.replace(urlBase+"edit2.html")}function setUpEditPage(){bugID=localStorage.getItem("editbugID");var e='{"id":'+bugID+"}",t=urlBase+"api/getBug",a=new XMLHttpRequest;a.open("POST",t,!1),a.setRequestHeader("Content-type","application/json; charset=UTF-8");try{a.send(e);var s=JSON.parse(a.responseText);1==s.success?(document.getElementById("titleBug").innerHTML="Editing "+s.common_name,document.getElementById("common_name").value=s.common_name,document.getElementById("scientific_name").value=s.characteristics.scientific_name,document.getElementById("class").value=s.characteristics.class,document.getElementById("order").value=s.characteristics.order,document.getElementById("family").value=s.characteristics.family,document.getElementById("genus").value=s.characteristics.genus,document.getElementById("color_1").value=s.characteristics.color1,document.getElementById("color_2").value=s.characteristics.color2,document.getElementById("general_type").value=s.characteristics.general_type,document.getElementById("mouth_parts").value=s.characteristics.mouth_parts,document.getElementById("description").value=s.description,document.getElementById("additional_advice").value=s.additional_advice,s.characteristics.wings&&(document.getElementById("wings").options[1].selected=!0),s.characteristics.antenna||(document.getElementById("antenna").options[1].selected=!0),s.characteristics.hind_legs_jump&&(document.getElementById("hind_legs").options[1].selected=!0),s.characteristics.hairy_furry&&(document.getElementById("hairy_furry").options[1].selected=!0),s.characteristics.thin_body&&(document.getElementById("thin_body").options[1].selected=!0)):window.location.replace(urlBase+"404.html")}catch(e){alert(e)}}function submitEdit(){var e,t,a,s,n;bugID=localStorage.getItem("editbugID"),e=1==document.getElementById("wings").options[1].selected?1:0,t=1==document.getElementById("antenna").options[1].selected?0:1,a=1==document.getElementById("hind_legs").options[1].selected?1:0,s=1==document.getElementById("hairy_furry").options[1].selected?1:0,n=1==document.getElementById("thin_body").options[1].selected?1:0;var r='{"common_name":"'+document.getElementById("common_name").value+'", "scientific_name":"'+document.getElementById("scientific_name").value+'", "class":"'+document.getElementById("class").value+'", "order":"'+document.getElementById("order").value+'", "family":"'+document.getElementById("family").value+'", "genus":"'+document.getElementById("genus").value+'", "color_1":"'+document.getElementById("color_1").value+'", "color_2":"'+document.getElementById("color_2").value+'", "general_type":"'+document.getElementById("general_type").value+'", "mouth_parts":"'+document.getElementById("mouth_parts").value+'", "wings": '+e+', "antenna": '+t+', "hind_legs_jump": '+a+', "hairy_furry": '+s+', "thin_body": '+n+', "description":"'+document.getElementById("description").value+'", "additional_advice":"'+document.getElementById("additional_advice").value+'", "bugid": '+bugID+"}",i=urlBase+"api/editBug",c=new XMLHttpRequest;c.open("POST",i,!1),c.setRequestHeader("X-Auth-Token",localStorage.getItem("sessionID"));try{c.send(r),1==JSON.parse(c.responseText).success?$(document.getElementById("addMessage")).append('<div class="alert alert-success alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Success!</strong> Edit has been added to submission list. </div>'):$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Error!</strong> Edit could not be submitted. Try again later. </div>')}catch(e){alert(e)}}function addBug(){try{var e=document.getElementById("common_name").value,t=document.getElementById("scientific_name").value,a=document.getElementById("class").value,s=document.getElementById("order").value,n=document.getElementById("family").value,r=document.getElementById("genus").value,i=document.getElementById("color_1").value,c=document.getElementById("color_2").value,d=document.getElementById("general_type").value,l=document.getElementById("mouth_parts").value,o=document.getElementById("description").value,u=document.getElementById("additional_advice").value,m=0,g=0,p=0,y=0,h=0;"True"==document.getElementById("wings").value&&(m=1),"True"==document.getElementById("antenna").value&&(g=1),"True"==document.getElementById("hind_legs").value&&(p=1),"True"==document.getElementById("hairy_furry").value&&(y=1),"True"==document.getElementById("thin_body").value&&(h=1)}catch(e){$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible" id="errorRegister">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Error!</strong> Could not add bug. </div>')}""!=e&&""!=t&&""!=a&&""!=s&&""!=n&&""!=r&&""!=i&&""!=c&&""!=d&&""!=l&&""!=o&&""!=u||$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible" id="missingIngo">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Missing information!</strong> Make sure all of the fields are filled out to add a bug. </div>');var v='{"common_name":"'+e+'", "scientific_name":"'+t+'", "class":"'+a+'", "order":"'+s+'", "family":"'+n+'", "genus":"'+r+'", "color_1":"'+i+'", "color_2":"'+c+'", "general_type":"'+d+'", "mouth_parts":"'+l+'", "wings":'+m+', "antenna":'+g+', "hind_legs_jump":'+p+', "hairy_furry":'+y+', "thin_body":'+h+', "description":"'+o+'", "additional_advice":"'+u+'"}',B=urlBase+"api/registerBug",I=new XMLHttpRequest;I.open("POST",B,!1),I.setRequestHeader("X-Auth-Token",localStorage.getItem("sessionID"));try{I.send(v);var _=JSON.parse(I.responseText);1==_.success?$(document.getElementById("addMessage")).append('<div class="alert alert-success alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Success!</strong> Added bug. </div>'):"This resource is for admins only"==_.message?$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Could not add bug!</strong> Only admins can add bugs! </div>'):$(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Could not add bug!</strong> Is it already in the database? </div>')}catch(e){alert(e.message)}}function PopulateTable(){var e=urlBase+"api/getEdits",t=new XMLHttpRequest;t.open("GET",e,!1),t.setRequestHeader("Content-type","application/json; charset=UTF-8");try{t.send("{}");var a=JSON.parse(t.responseText);if(1==a.success){var s=document.getElementById("approveTable");Array.from(a.submissions).forEach(function(e,t){addRowOnApproveTable(s,e,t)})}}catch(e){alert(e)}}function addRowOnApproveTable(e,t,a){if(null!=t){var s,n,r="",i="",c='{"id":"'+t.bug_id_old+'"}',d=urlBase+"api/getBug";(l=new XMLHttpRequest).open("POST",d,!1),l.setRequestHeader("Content-type","application/json; charset=UTF-8");try{l.send(c),s=JSON.parse(l.responseText)}catch(e){return void alert(e)}var l;c='{"id":"'+t.bug_id_new+'"}';(l=new XMLHttpRequest).open("POST",d,!1),l.setRequestHeader("Content-type","application/json; charset=UTF-8");try{l.send(c),n=JSON.parse(l.responseText)}catch(e){return void alert(e)}r=s.common_name+" / "+s.characteristics.scientific_name+"\n\n",i=n.common_name+" / "+n.characteristics.scientific_name+"\n\n",s.characteristics.class!=n.characteristics.class&&(r=r+"class: "+s.characteristics.class+"\n\n",i=i+"class: "+n.characteristics.class+"\n\n"),s.characteristics.order!=n.characteristics.order&&(r=r+"order: "+s.characteristics.order+"\n\n",i=i+"order: "+n.characteristics.order+"\n\n"),s.characteristics.family!=n.characteristics.family&&(r=r+"family: "+s.characteristics.family+"\n\n",i=i+"family: "+n.characteristics.family+"\n\n"),s.characteristics.genus!=n.characteristics.genus&&(r=r+"genus: "+s.characteristics.genus+"\n\n",i=i+"genus: "+n.characteristics.genus+"\n\n"),s.characteristics.color1!=n.characteristics.color1&&(r=r+"Primary color: "+s.characteristics.color1+"\n\n",i=i+"Primary color: "+n.characteristics.color1+"\n\n"),s.characteristics.color2!=n.characteristics.color2&&(r=r+"Secondary color: "+s.characteristics.color2+"\n\n",i=i+"Secondary color: "+n.characteristics.color2+"\n\n"),s.characteristics.antenna!=n.characteristics.antenna&&(r=r+"Antenna: "+s.characteristics.antenna+"\n\n",i=i+"Antenna: "+n.characteristics.antenna+"\n\n"),s.characteristics.general_type!=n.characteristics.general_type&&(r=r+"General type: "+s.characteristics.general_type+"\n\n",i=i+"General type: "+n.characteristics.general_type+"\n\n"),s.characteristics.hairy_furry!=n.characteristics.hairy_furry&&(r=r+"Furry: "+s.characteristics.hairy_furry+"\n\n",i=i+"Furry: "+n.characteristics.hairy_furry+"\n\n"),s.characteristics.hind_legs_jump!=n.characteristics.hind_legs_jump&&(r=r+"Jumping legs: "+s.characteristics.hind_legs_jump+"\n\n",i=i+"Jumping legs: "+n.characteristics.hind_legs_jump+"\n\n"),s.characteristics.mouth_parts!=n.characteristics.mouth_parts&&(r=r+"Mouth parts: "+s.characteristics.mouth_parts+"\n\n",i=i+"Mouth parts: "+n.characteristics.mouth_parts+"\n\n"),s.characteristics.wings!=n.characteristics.wings&&(r=r+"Wings: "+s.characteristics.wings+"\n\n",i=i+"Wings: "+n.characteristics.wings+"\n\n"),s.description!=n.description&&(r=r+"Description: "+s.description+"\n\n",i=i+"Description: "+n.description+"\n\n"),s.additional_advice!=n.additional_advice&&(r=r+"Additional advice: "+s.additional_advice+"\n\n",i=i+"Additional advice: "+n.additional_advice+"\n\n"),$(e).find("tbody").append("<tr><td>"+r+"</td><td>"+i+"</td><td><button type='button' id='approvebutton"+t.submission_id+"'>Approve!</button> </td><td> <button type='button' id='rejectbutton"+t.submission_id+"'>Reject!</button> </td></tr>"),document.getElementById("approvebutton"+t.submission_id).onclick=function(){approveEdit(t.submission_id)},document.getElementById("rejectbutton"+t.submission_id).onclick=function(){rejectEdit(t.submission_id)}}}function approveEdit(e){var t='{"id":'+e+', "approve":true}',a=urlBase+"api/approveEdit",s=new XMLHttpRequest;s.open("POST",a,!1),s.setRequestHeader("X-Auth-Token",localStorage.getItem("sessionID"));try{if(s.send(t),result=JSON.parse(s.responseText),1==result.success){$(document.getElementById("addMessage")).append('<div class="alert alert-success alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Success!</strong> Edit approved. </div>');for(var n=document.getElementById("approveTable");1<n.rows.length;)n.deleteRow(1);PopulateTable()}else $(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Approve failed!</strong> Only admins can approve or reject edits. </div>')}catch(e){return void alert(e)}}function rejectEdit(e){var t='{"id":'+e+', "approve":false}',a=urlBase+"api/approveEdit",s=new XMLHttpRequest;s.open("POST",a,!1),s.setRequestHeader("X-Auth-Token",localStorage.getItem("sessionID"));try{if(s.send(t),result=JSON.parse(s.responseText),1==result.success){$(document.getElementById("addMessage")).append('<div class="alert alert-success alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Success!</strong> Edit successfully rejected. </div>');for(var n=document.getElementById("approveTable");1<n.rows.length;)n.deleteRow(1);PopulateTable()}else $(document.getElementById("addMessage")).append('<div class="alert alert-danger alert-dismissible">  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>  <strong>Reject failed!</strong> Only admins can approve or reject edits. </div>')}catch(e){return void alert(e)}}